import{u as S,q as D,a,j as e}from"./index-BEwr_gqB.js";import{u as se,b as ae,c as ie,d as ne,e as le,M as C}from"./useThread-BZzVL9rf.js";import{T as d}from"./Tooltip-CYTQWIxN.js";import{u as q}from"./useMutation-C0FTNoCi.js";import"./useQuery-DjqTdcA7.js";function re(){const n=S();return q({mutationFn:({id:r,position:c})=>D.moveToPosition(r,c),onSuccess:()=>{n.invalidateQueries({queryKey:["threads"]})}})}function oe(){const n=S();return q({mutationFn:r=>D.moveToFront(r),onSuccess:()=>{n.invalidateQueries({queryKey:["threads"]})}})}function ce(){const n=S();return q({mutationFn:r=>D.moveToBack(r),onSuccess:()=>{n.invalidateQueries({queryKey:["threads"]})}})}const p={title:"",format:"",issuesRemaining:1,notes:""};function he(){const{data:n,isLoading:r}=se(),c=ae(),m=ie(),A=ne(),h=le(),I=oe(),P=ce(),_=re(),[Q,g]=a.useState(!1),[B,b]=a.useState(!1),[K,f]=a.useState(!1),[s,o]=a.useState(p),[i,u]=a.useState(p),[R,M]=a.useState(null),[v,j]=a.useState(""),[E,w]=a.useState(1),[N,y]=a.useState(null),[L,x]=a.useState(null),T=n?.filter(t=>t.status==="active")??[],k=n?.filter(t=>t.status==="completed")??[],U=t=>{window.confirm("Are you sure you want to delete this thread?")&&A.mutate(t)},Y=t=>{I.mutate(t)},$=t=>{P.mutate(t)},z=t=>l=>{l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain",String(t)),y(t)},G=t=>l=>{l.preventDefault(),x(t)},H=t=>l=>{if(l.preventDefault(),!N||N===t){x(null);return}const O=T.find(te=>te.id===t);O&&_.mutate({id:N,position:O.position}),y(null),x(null)},J=()=>{y(null),x(null)},V=t=>{t.preventDefault(),c.mutate({title:s.title,format:s.format,issues_remaining:Number(s.issuesRemaining),notes:s.notes||null},{onSuccess:()=>{o(p),g(!1)}})},W=t=>{t.preventDefault(),R&&m.mutate({id:R.id,data:{title:i.title,format:i.format,notes:i.notes||null}},{onSuccess:()=>{M(null),b(!1)}})},X=t=>{M(t),u({title:t.title,format:t.format,issuesRemaining:t.issues_remaining,notes:t.notes||""}),b(!0)},F=t=>{j(t?.id?String(t.id):""),w(1),f(!0)},Z=t=>{t.preventDefault(),v&&h.mutate({thread_id:Number(v),issues_to_add:Number(E)},{onSuccess:()=>{f(!1),j(""),w(1)}})},ee=()=>{o(p),g(!0)};return r?e.jsx("div",{className:"flex items-center justify-center h-screen",children:"Loading..."}):e.jsxs("div",{className:"space-y-10 pb-10",children:[e.jsxs("header",{className:"flex justify-between items-start px-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black tracking-tighter text-glow mb-1 uppercase",children:"Read Queue"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Your upcoming comics"})]}),e.jsx("button",{type:"button",onClick:ee,className:"h-12 px-5 glass-button text-xs font-black uppercase tracking-widest whitespace-nowrap shadow-xl",children:"Add Thread"})]}),T.length===0?e.jsx("div",{className:"text-center text-slate-500",children:"No active threads in queue"}):e.jsx("div",{id:"queue-container",role:"list","aria-label":"Thread queue",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:T.map(t=>{const l=L===t.id;return e.jsxs("div",{className:`glass-card p-4 space-y-3 group transition-all hover:border-white/20 ${l?"border-amber-400/60":""}`,onDragOver:G(t.id),onDrop:H(t.id),children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(d,{content:"Drag to reorder within the queue.",children:e.jsx("button",{type:"button",className:"text-slate-500 hover:text-slate-300 transition-colors text-lg",draggable:!0,onDragStart:z(t.id),onDragEnd:J,"aria-label":"Drag to reorder",children:"⠿"})}),e.jsx("h3",{className:"text-lg font-bold text-white flex-1 truncate",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{content:"Edit thread details.",children:e.jsx("button",{type:"button",onClick:()=>X(t),className:"text-slate-500 hover:text-white transition-colors text-sm","aria-label":"Edit thread",children:"✎"})}),e.jsx(d,{content:"Delete thread from queue.",children:e.jsx("button",{type:"button",onClick:()=>U(t.id),className:"text-slate-500 hover:text-red-400 transition-colors text-xl","aria-label":"Delete thread",children:"×"})})]})]}),e.jsx("p",{className:"text-sm text-slate-400",children:t.format}),t.notes&&e.jsx("p",{className:"text-xs text-slate-500",children:t.notes}),t.issues_remaining!==null&&e.jsxs("p",{className:"text-xs text-slate-500",children:[t.issues_remaining," issues remaining"]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(d,{content:"Move this thread to the front of the queue.",children:e.jsx("button",{onClick:()=>Y(t.id),className:"flex-1 py-2 bg-white/5 border border-white/10 text-slate-400 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-white/10 transition-all",children:"Front"})}),e.jsx(d,{content:"Move this thread to the back of the queue.",children:e.jsx("button",{onClick:()=>$(t.id),className:"flex-1 py-2 bg-white/5 border border-white/10 text-slate-400 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-white/10 transition-all",children:"Back"})})]})]},t.id)})}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("header",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black uppercase text-slate-200",children:"Completed Threads"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Reactivate finished series"})]}),e.jsx("button",{type:"button",onClick:()=>F(null),className:"h-10 px-4 bg-white/5 border border-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-300 hover:bg-white/10",children:"Reactivate"})]}),k.length===0?e.jsx("div",{className:"text-center text-slate-500",children:"No completed threads yet"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(t=>e.jsxs("div",{className:"glass-card p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-black text-slate-200 truncate",children:t.title}),e.jsx("p",{className:"text-[8px] font-black text-slate-500 uppercase tracking-widest",children:t.format})]}),e.jsx("button",{type:"button",onClick:()=>F(t),className:"px-3 py-1 bg-white/5 border border-white/10 rounded-lg text-[9px] font-black uppercase tracking-widest text-slate-300 hover:bg-white/10",children:"Reactivate"})]}),t.notes&&e.jsx("p",{className:"text-xs text-slate-500",children:t.notes})]},t.id))})]}),e.jsx(C,{isOpen:Q,title:"Create Thread",onClose:()=>g(!1),children:e.jsxs("form",{className:"space-y-4",onSubmit:V,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Title"}),e.jsx("input",{value:s.title,onChange:t=>o({...s,title:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Format"}),e.jsx("input",{value:s.format,onChange:t=>o({...s,format:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Issues Remaining"}),e.jsx("input",{type:"number",min:"0",value:s.issuesRemaining,onChange:t=>o({...s,issuesRemaining:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Notes"}),e.jsx("textarea",{value:s.notes,onChange:t=>o({...s,notes:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200 min-h-[80px]"})]}),e.jsx("button",{type:"submit",disabled:c.isPending,className:"w-full py-3 glass-button text-xs font-black uppercase tracking-widest disabled:opacity-60",children:c.isPending?"Creating...":"Create Thread"})]})}),e.jsx(C,{isOpen:B,title:"Edit Thread",onClose:()=>b(!1),children:e.jsxs("form",{className:"space-y-4",onSubmit:W,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Title"}),e.jsx("input",{value:i.title,onChange:t=>u({...i,title:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Format"}),e.jsx("input",{value:i.format,onChange:t=>u({...i,format:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:t=>u({...i,notes:t.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200 min-h-[80px]"})]}),e.jsx("button",{type:"submit",disabled:m.isPending,className:"w-full py-3 glass-button text-xs font-black uppercase tracking-widest disabled:opacity-60",children:m.isPending?"Saving...":"Save Changes"})]})}),e.jsx(C,{isOpen:K,title:"Reactivate Thread",onClose:()=>f(!1),children:e.jsxs("form",{className:"space-y-4",onSubmit:Z,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Completed Thread"}),e.jsxs("select",{value:v,onChange:t=>j(t.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0,children:[e.jsx("option",{value:"",children:"Select a thread..."}),k.map(t=>e.jsxs("option",{value:t.id,children:[t.title," (",t.format,")"]},t.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Issues to Add"}),e.jsx("input",{type:"number",min:"1",value:E,onChange:t=>w(t.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2 text-sm text-slate-200",required:!0})]}),e.jsx("button",{type:"submit",disabled:h.isPending,className:"w-full py-3 glass-button text-xs font-black uppercase tracking-widest disabled:opacity-60",children:h.isPending?"Reactivating...":"Reactivate Thread"})]})})]})}export{he as default};
