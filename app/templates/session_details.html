<div class="bg-gray-50 rounded-lg p-4 space-y-3">
    {% if narrative_summary.read or narrative_summary.skipped or narrative_summary.completed %}
    <div class="space-y-4 mb-6 p-4 bg-white rounded-md border border-gray-200 shadow-sm">
        <h3 class="font-bold text-lg text-gray-800 border-b pb-2">Narrative Summary</h3>

        {% if narrative_summary.read %}
        <div>
            <h4 class="font-bold text-sm text-gray-700 uppercase tracking-wider">Read:</h4>
            <ul class="list-disc list-inside text-gray-600 ml-2">
                {% for item in narrative_summary.read %}
                <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if narrative_summary.skipped %}
        <div>
            <h4 class="font-bold text-sm text-gray-700 uppercase tracking-wider">Skipped:</h4>
            <ul class="list-disc list-inside text-gray-600 ml-2">
                {% for item in narrative_summary.skipped %}
                <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if narrative_summary.completed %}
        <div>
            <h4 class="font-bold text-sm text-gray-700 uppercase tracking-wider text-green-700">Completed:</h4>
            <ul class="list-disc list-inside text-green-600 ml-2">
                {% for item in narrative_summary.completed %}
                <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <h3 class="font-semibold text-gray-700">Session Events</h3>
    {% if events %}
    <div class="space-y-2">
        {% for event in events %}
        <div class="border-l-2 border-blue-300 pl-3 py-1">
            <p class="text-sm text-gray-500">
                {{ event.timestamp.strftime('%I:%M %p') }}
            </p>
            {% if event.type == "roll" %}
            <p class="font-medium">
                Rolled d{{ event.die }} → {{ event.result }}
                {% if event.thread_title %}
                → Selected: {{ event.thread_title }}
                {% endif %}
                {% if event.selection_method %}
                <span class="text-sm text-gray-500">({{ event.selection_method }})</span>
                {% endif %}
            </p>
            {% elif event.type == "rate" %}
            <p class="font-medium">
                {% if event.thread_title %}{{ event.thread_title }}{% endif %}
                Rated {{ event.rating }}/5.0
                {% if event.issues_read %}
                ({{ event.issues_read }} issue{% if event.issues_read > 1 %}s{% endif %})
                {% endif %}
            </p>
            <p class="text-sm text-gray-600">
                Queue: {{ event.queue_move }} → d{{ event.die_after }}
            </p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-gray-500 text-sm">No events recorded</p>
    {% endif %}
</div>
